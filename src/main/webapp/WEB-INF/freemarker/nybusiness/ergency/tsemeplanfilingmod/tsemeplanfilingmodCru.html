<#ftl output_format="HTML" auto_esc=true>
<@h.commonHead title="后台管理系统" keywords="开源,永久免费" description="springrain开源系统管理后台"/>

<script src="${ctx}/js/validform/validform.min.js"></script>
<link rel="stylesheet" href="${ctx}/js/validform/validform.css" media="all">
<script type="text/javascript" src="${ctx}/js/My97DatePicker/WdatePicker.js"></script>
<link rel="stylesheet" href="${ctx}/js/My97DatePicker/skin/default/datepicker.css" />
<script type="text/javascript" src="${ctx}/js/ztree/js/jquery.ztree.all-3.5.js"></script>
<script type="text/javascript" src="${ctx}/js/ztree/js/ztreeUtils.js"></script>
<script type="text/javascript" src="${ctx}/js/select2/js/select2.full.min.js"></script>
<script type="text/javascript" src="${ctx}/js/select2/js/i18n/zh-CN.js"></script>
<script type="text/javascript" src="${ctx}/js/custom/common/select2remote.js"></script>
<link rel="stylesheet" href="${ctx}/js/select2/css/select2.min.css" type="text/css">
<link rel="stylesheet" href="${ctx}/js/ztree/css/zTreeStyle/zTreeStyle.css" type="text/css">
<link rel="stylesheet" href="${ctx}/css/custom/common/myztree.css" type="text/css">
<script>
	 jQuery(function(){
		 /*
		 init_valid(_before,_after)
		 @_before:提交表单前，调用 的函数   可以为空，一般有validform处理不了，独自进行处理时使用
		 @_after:保存成功后，调用的函数  可以为空，一般为对应的列表页面
		 */
		 springrain.initValid(null,function(){window.location.href="${ctx}/tsemeplanfilingmod/list?springraintoken="+springraintoken});
	 });
</script>
</head>
<body>
	<div class="layui-layout layui-layout-admin">
		<@h.naviHeader /><@h.leftMenu />
		<!-- 主体内容开始 -->
			<div class="layui-tab layui-tab-brief">
				<ul class="layui-tab-title site-demo-title">
		            <li class="layui-this">
		            </li>
		             <li style="float:right;">
				        <button type="button" onclick="history.go(-1)" class="layui-btn layui-btn-small" style="margin-top:8px;"><i class="layui-icon layui-icon-specil">&#xe603;</i>返回</button>
		             </li>
	       		</ul>
				
				<div class="layui-body layui-tab-content site-demo-body">
					<div class="layui-tab-item layui-show">
							<div class="layui-main">
						          <div id="LAY_preview" class="layui-my-form">
						          				<header class="larry-personal-tit">
													<span>环境应急预案变更备案表</span>
												</header>
												<div class="larry-personal-body clearfix changepwd">
													<form id="validForm" class="layui-form <!--  -->"  method="post" action="${ctx}/tsemeplanfilingmod/update">
														<input type="hidden" id="id" name="id" />
														
														<div class="layui-form-item">
															<div class="layui-inline">
																<label class="layui-form-label">单位名称*</label>
																<div class="layui-input-inline " style=" width: 600px">  
																	<input type="text" readonly name="company_name" id="company_name" datatype="*" nullmsg="不能为空" errormsg="不能为空！" autocomplete="off" class="layui-input" value="${(returnDatas.data.companyName)!''}">
																</div>
															</div>
														</div>
														<div class="layui-form-item">
															<div class="layui-inline">
																 <label class="layui-form-label">联系人*</label>
																<div class="layui-input-inline">
																	<input type="text" name="contact" id="contact" datatype="*" nullmsg="不能为空" errormsg="不能为空！" autocomplete="off" class="layui-input" value="${(returnDatas.data.contact)!''}">  
																</div>
															</div>
															<div class="layui-inline">
																 <label class="layui-form-label">联系电话*</label>
																<div class="layui-input-inline">
																	<input type="text" name="contact_tel" id="contact_tel" datatype="*" nullmsg="不能为空" errormsg="不能为空！" autocomplete="off" class="layui-input" value="${(returnDatas.data.contact_tel)!''}">  
																</div>
															</div>
														</div>
														
														<div class="layui-form-item">
															<div class="layui-inline">
																 <label class="layui-form-label">单位地址*</label>
																<div class="layui-input-inline">
																	<input type="text" name="bak2" id="bak2" datatype="*" nullmsg="不能为空" errormsg="不能为空！" autocomplete="off" class="layui-input" value="${(returnDatas.data.bak2)!''}">  
																</div>
															</div>
															<div class="layui-inline">
																 <label class="layui-form-label">备案编号*</label>
																<div class="layui-input-inline">
																	<input type="text" name="beian_number" id="beian_number" datatype="*" nullmsg="不能为空" errormsg="不能为空！" autocomplete="off" class="layui-input" value="${(returnDatas.data.beian_number)!''}">  
																</div>
															</div>
														</div>
															<div class="layui-form-item">
															<div class="layui-inline">
															 <label class="layui-form-label">补充调整内容*</label> 
																	<button type="button" onclick="add()" class="layui-btn">目录管理</button>
															</div>
															<div class="layui-inline">
															<label class="layui-form-label"></label>
																		   <div style="margin-left: 30px" class="layui-inline col-lg-9">  
																				 <table  class="layui-table  <#if (returnDatas.data??) &&(returnDatas.data.filadjustment??) &&(returnDatas.data.filadjustment?size gt 0)><#else>off</#if>">
																					 	<colgroup>
																				    		<col width="">
																					    	<col width="200">
																					    	<col width="200">
																					    	<col width="40">
																				  		</colgroup>
																				  		<thead>
																							<tr>
																								<th>补充调整目录</th>
																								<th>补充调整内容</th>
																								<th>操作</th>
																							</tr>
																						</thead>
																						<tbody id="addTbody">
																							<#if (returnDatas.data??) &&(returnDatas.data.filadjustment??) &&(returnDatas.data.filadjustment?size gt 0)>
																								<#list returnDatas.data.filadjustment as _data>
																									<tr>
																										<td><input type='text'  name='adjustment_catalog' class='layui-input' value="${(_data.adjustment_catalog)!''}">
																											<input type='hidden' name='adjustment_id' value="${(_data.adjustment_id)!''}">
																										</td>
																										<td><input type='text'  name='adjustment_desc' class='layui-input' value="${(_data.adjustment_desc)!''}">
																										</td>
																										<td><a onclick='del(this)' class='layui-btn layui-btn-danger layui-btn-mini ajax-delete'>删除</a></td>
																									</tr>
																								</#list>
																							</#if>
																						</tbody>
																					</table>
																			</div>
															</div>
														</div> 		
														<div class="layui-form-item">
														<label class="layui-form-label">申请调整或补充理由*</label> 
																<div class="layui-input-inline " style=" width: 600px"> 
																<input  type="text" name="adjustment_reason" id="adjustment_reason"  datatype="*" nullmsg="不能为空" errormsg="不能为空！" autocomplete="off" class="layui-input" value="${(returnDatas.data.adjustment_reason)!''}"></br>
																 <h4 style="margin-left: 300px">（单位公章）：    </h4>
																<input style="margin-left: 400px;width: 100px" type="text"  name="apply_date" id="apply_date" onClick="WdatePicker()" datatype="*" nullmsg="不能为空" errormsg="不能为空！" autocomplete="off" class="layui-input" value="${(returnDatas.data.apply_date)!''}">
																</div>
														</div> 	
															
															
													<div class="layui-form-item change-submit">
													<label class="layui-form-label"></label>
															<div class="layui-inline">
																<button type="button" class="layui-btn" id="smtbtn" style="margin-left: 200px">保存</button>
																<button type="button" class="layui-btn layui-btn-primary" id="rstbtn">重置</button>
															</div>
														</div>
													</form>
												</div>
								  </div>
							</div>
					</div>
			</div>
		</div>
		<!-- 主体内容结束 -->
		<@h.footer />
	</div>
</body>
<script>
function add(){
	jQuery("#addTbody").parents("table").removeClass("off");
	var _html=["<tr>",
					"<td><input type='text'    name='adjustment_catalog' class='layui-input'><input type='hidden' name='adjustment_id'></td>",
					"<td><input type='text'    name='adjustment_desc' class='layui-input'>",
					"<td><a onclick='del(this)' class='layui-btn layui-btn-danger layui-btn-mini ajax-delete'>删除</a></td>",
				"</tr>"].join('');
	var _html=jQuery(_html);
	jQuery("#addTbody").append(_html);
	form.render();
	jQuery(_html).find("input[name='adjustment_catalog']").trigger("click");
	
}
function del(_obj){
	springrain.confirm("确认删除?",function(){
		jQuery(_obj).parents("tr").remove();
	});
}
</script>
</html>
